<!doctype html>
<html lang="sk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mini Geometry Dash — jednoduchá hra</title>
  <style>
    :root{--bg:#0f1724;--ground:#1f2937;--accent:#ff3b3b;--player:#ffd166;}
    html,body{height:100%;margin:0;background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    .wrap{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:12px}
    canvas{background:linear-gradient(#0b1220,#071026);border-radius:8px;box-shadow:0 8px 30px rgba(2,6,23,.7)}
    .ui{color:#cbd5e1;text-align:center}
    .controls{margin-top:6px}
    button{background:#111827;color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
    .footer{font-size:13px;color:#94a3b8}
  </style>
</head>
<body>
  <div class="wrap">
    <canvas id="game" width="900" height="450"></canvas>
    <div class="ui">
      <div>Skóre: <span id="score">0</span> — Najlepší: <span id="best">0</span></div>
      <div class="controls">Hrať: <strong>medzerník / šípka hore / klik / tap</strong>. Po smrti stlač <button id="restartBtn">Restart</button></div>
      <div class="footer">Jednoduchá verzia inšpirovaná Geometry Dash. Chceš pomalšie prekážky, viac úrovní alebo hudbu?</div>
    </div>
  </div>

<script>
// --- Jednoduchá hra podobná Geometry Dash (v jednom HTML súbore)
// Ovládanie: Space / ArrowUp / klik / tap -> skok

const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const scoreEl = document.getElementById('score');
const bestEl = document.getElementById('best');
const restartBtn = document.getElementById('restartBtn');

let W = canvas.width, H = canvas.height;
window.addEventListener('resize', () => {}); // zachováme pevné rozlíšenie pre jednoduchšiu implementáciu

// Hráč
const player = {
  x: 120,
  y: H - 60,
  w: 40,
  h: 40,
  vy: 0,
  gravity: 0.9,
  jumpPower: -14,
  onGround: true,
  color: '#ffd166'
};

// Prekážky
let obstacles = [];
let spawnTimer = 0;
let spawnInterval = 90; // nižšie = častejšie
let speed = 6; // rýchlosť scény

// Parallax pozadie
const clouds = [];
for(let i=0;i<6;i++) clouds.push({x:Math.random()*W,y:30+Math.random()*120,w:80+Math.random()*120,v:0.3+Math.random()*0.6});

// Stav hry
let running = true;
let score = 0;
let best = parseInt(localStorage.getItem('gd_best')||'0',10);
bestEl.textContent = best;

function reset(){
  obstacles = [];
  spawnTimer = 0;
  speed = 6;
  score = 0;
  player.y = H - 60;
  player.vy = 0;
  running = true;
}

function spawnObstacle(){
  const h = 30 + Math.random()*80; // výška prekážky
  obstacles.push({x: W + 40, w: 30 + Math.random()*30, h: h, y: H - h - 20});
}

function rectsCollide(a,b){
  return a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y;
}

// Vytvor drobné častice pri dopade (len vizuálne)
let particles = [];
function spawnParticles(x,y,color){
  for(let i=0;i<10;i++) particles.push({x,y, vx:(Math.random()-0.5)*6, vy:(Math.random()-0.8)*6, life:30, color});
}

// Hlavný update
function update(){
  if(!running) return;
  // pozadie
  clouds.forEach(c => { c.x -= c.v* (speed/6); if(c.x + c.w < 0) c.x = W + Math.random()*200; });

  // hráč fyzika
  player.vy += player.gravity;
  player.y += player.vy;
  if(player.y + player.h >= H - 20){
    if(player.vy > 1) spawnParticles(player.x + player.w/2, H - 20, player.color);
    player.y = H - 20 - player.h;
    player.vy = 0;
    player.onGround = true;
  } else player.onGround = false;

  // prekážky
  spawnTimer++;
  if(spawnTimer > spawnInterval){
    spawnObstacle();
    spawnTimer = 0;
    // postupne zrýchľuj a skracuj interval, ale zvoľnene
    if(spawnInterval > 45) spawnInterval -= 1;
    speed += 0.12 * (Math.random()>0.5?1:0);
  }

  obstacles.forEach(o => { o.x -= speed; });
  obstacles = obstacles.filter(o => o.x + o.w > -50);

  // kolízie
  obstacles.forEach(o => {
    if(rectsCollide(player, o)){
      running = false;
      spawnParticles(player.x + player.w/2, player.y + player.h/2, '#ff4d6d');
      if(score > best){ best = Math.floor(score); localStorage.setItem('gd_best', best); bestEl.textContent = best; }
    }
  });

  // particle update
  particles.forEach(p => { p.x += p.vx; p.y += p.vy; p.vy += 0.3; p.life -= 1; });
  particles = particles.filter(p => p.life > 0);

  // skóre
  score += 0.1 * (speed/6);
  scoreEl.textContent = Math.floor(score);
}

// Draw
function draw(){
  // pozadie
  ctx.clearRect(0,0,W,H);
  // gradient nebesa
  const g = ctx.createLinearGradient(0,0,0,H);
  g.addColorStop(0,'#071026'); g.addColorStop(1,'#00111f');
  ctx.fillStyle = g; ctx.fillRect(0,0,W,H);

  // clouds
  ctx.globalAlpha = 0.9;
  clouds.forEach(c => {
    ctx.fillStyle = 'rgba(200,220,255,0.08)';
    ctx.beginPath(); ctx.ellipse(c.x, c.y, c.w, 24, 0,0,Math.PI*2); ctx.fill();
  });
  ctx.globalAlpha = 1;

  // ground
  ctx.fillStyle = '#071625'; ctx.fillRect(0, H - 20, W, 20);
  ctx.fillStyle = '#0b3344'; ctx.fillRect(0, H - 20, W, 6);

  // obstacles
  obstacles.forEach(o => {
    ctx.fillStyle = '#ff3b3b';
    ctx.fillRect(o.x, o.y, o.w, o.h);
    // spike detail
    ctx.fillStyle = '#fff2';
    for(let i=0;i<Math.ceil(o.w/8);i++){
      const px = o.x + i*8;
      ctx.beginPath(); ctx.moveTo(px, o.y); ctx.lineTo(px+4, o.y - 8); ctx.lineTo(px+8, o.y); ctx.fill();
    }
  });

  // player
  ctx.fillStyle = player.color;
  ctx.fillRect(player.x, player.y, player.w, player.h);
  // eye
  ctx.fillStyle = 'rgba(0,0,0,0.2)'; ctx.fillRect(player.x + player.w - 14, player.y + 10, 6, 6);

  // particles
  particles.forEach(p => { ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, 3,3); });

  if(!running){
    ctx.fillStyle = 'rgba(0,0,0,0.5)'; ctx.fillRect(0,0,W,H);
    ctx.fillStyle = '#fff'; ctx.font = '28px system-ui'; ctx.textAlign='center';
    ctx.fillText('Game Over', W/2, H/2 - 10);
    ctx.font = '16px system-ui'; ctx.fillText('Stlač Restart alebo Space pre novú hru', W/2, H/2 + 20);
  }
}

// loop
function loop(){ update(); draw(); requestAnimationFrame(loop); }
requestAnimationFrame(loop);

// Ovládanie
function jump(){
  if(!running){ reset(); return; }
  if(player.onGround){ player.vy = player.jumpPower; player.onGround = false; spawnParticles(player.x + player.w/2, player.y + player.h, player.color); }
}

window.addEventListener('keydown', e => { if(e.code === 'Space' || e.code === 'ArrowUp') { e.preventDefault(); jump(); } });
window.addEventListener('pointerdown', e => { jump(); });
restartBtn.addEventListener('click', () => { reset(); });

// rýchly restart cez Space keď nie je running
window.addEventListener('keyup', e => { if((e.code === 'Space' || e.code === 'ArrowUp') && !running){ reset(); } });

// adaptívne zmeny pre menšie obrazovky
(function adapt(){
  if(window.innerWidth < 800){ canvas.width = Math.min(720, window.innerWidth - 40); canvas.height = Math.round(canvas.width * 0.5); W = canvas.width; H = canvas.height; }
})();

</script>
</body>
</html>
